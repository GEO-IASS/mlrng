context("predict")

test_that("Step by step modeling", {
  task = Tasks$get("iris")
  learner = Learners$get("classif.dummy")
  model = train(task, learner, subset = sample(150, 120))
  expect_is(model, "WrappedModel")
  pred = predict(model, task)
  expect_integer(pred$ids, len = 30, any.missing = FALSE)
  expect_character(pred$response, len = 30, any.missing = FALSE)
  expect_subset(pred$response, levels(iris$Species))

  train = sample(150, 100)
  test = setdiff(seq_len(150), train)
  learner = Learners$get("classif.rpart")
  model = train(task, learner, subset = train)
  expect_is(model, "WrappedModel")
  pred = predict(model, task, subset = test)
  expect_integer(pred$ids, len = length(test), any.missing = FALSE)
  expect_character(pred$response, len = length(test), any.missing = FALSE)
  expect_subset(pred$response, levels(iris$Species))
})
